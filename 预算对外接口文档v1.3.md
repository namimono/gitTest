> 预算对外接口，所有传入传出参数都以小驼峰命名



> **dev:**
>
> 地址： http://172.16.176.64:38000/
>
> access_token：Y5zDEQuvRA4VMUQS7Nuj



# 1、预算执行接口（可测试）

## 接口说明

提供异构系统的预算执行操作的接口，通过执行类型参数来指定操作方式。

## 请求说明

### 请求地址

/v1/rest/executions

### 方法

POST

### 接口认证

在HTTP header中添加

access_token: xxxxx

access_token由预算系统生成分配，在接入前需要协商分配，修改也需要双方协商修改

### 参数说明

budgetCode（可选）：预算编码

cycle（可选）：预算周期

orgCode（可选）：组织编码

depCode（可选）：部门编码

subCode（可选）：科目编码

projCode（可选）：项目编码

executeAmount（必填）：执行金额

executeDate（必填）：执行日期

**frozenCode(必填)：冻结单号**

executeType（必填）：执行类型，可选的类型有1、冻结 2、释放冻结 3、占用 4、释放占用 5、新增预算 6、预算调整7、释放冻结并且占用 8、释放占用并且冻结

executeAbstract（必填）： 执行摘要说明，执行记录的文本说明

sourceCode（可选）：来源系统唯一码，预算执行系统自行约束，用于报表、联查

processLink（可选）：流程链接，预算执行系统自行约束，用于报表、联查

processName（可选）：流程名称，预算执行系统自行约束，用于报表、联查

sourceMark（必填）：来源标记，来源系统的系统简写

moduleName（可选）：模块名称，预算执行系统自行约束，用于报表、联查

#### 参数使用说明

①budgetCode预算编号可以唯一确定一条预算数据

②cycle，orgCode，depCode，subCode，projCode可以唯一确定一条预算

根据①的预算编号和②的预算维度组合都可以确定唯一的预算，所以①和②在调用执行接口时必须选择其一传入。

### 参数示例

参数需要放入request请求的body中，参数示例如下：

* 预算编号执行预算：

```json
{"budgetCode":"BC0000000001","executeAmount":"1000.00","executeDate":"2020-10-31","executeType":"1","executeAbstract":"执行冻结","sourceMark":"contract"}
```

* 维度执行预算：

```json
{"budgetCycle":"2020","cycle":"2020","orgCode":"00001","depCode":"00001","subCode":"00002","projCode":"00003","executeAmount":"1000.00","executeDate":"2020-10-31","executeType":"1","executeAbstract":"执行冻结","sourceMark":"contract"}
```

## 返回说明

**code**：执行接口，200代表接口成功，非200表示系统出错，具体出错信息请参考message提示信息

**message**：当code为200，message返回"成功"， 如果非200会提示相关的报错信息

**data**：在执行类型（executeType）为1和3时，会有超预算的可能，超预算有3种控制方式

* 不可超预算：code会返回特定的非0值，并且message信息会有提示，无data数据

* 超预算不提示: code返回200，无data提示

* 超预算提示：code返回200，data数据中会有超预算的提示信息，数据格式如：

  ```json
  data: {
    tip:“本次申请{预算维度一套字段}{本次申请金额}‘已超出’{超出部分的金额}，请注意预算执行情况”
  }
  ```

#### 返回示例

* 执行成功，没有提示信息

```json
{"code":"200","message":"success"}
```

* 执行成功，有提示信息

```json
{"code":"200","message":"success","data":{"tip":"本次申请{预算维度一套字段}{本次申请金额}‘已超出’{超出部分的金额}，请注意预算执行情况"}}
```

说明：tip是模板消息，在预算系统中进行填充，仅用于调用系统显示

* 执行发生错误，或不可超预算是

```json
{"code":"5001","message":"执行金额已经超预算"}
```

说明：此处code值仅供参考，具体值需要在接口实现时确定

# 2. 查询指定预算接口（可测试）

## 接口说明

根据预算编号或预算维度的组合查询，获取预算的详细信息

## 请求说明

### 请求地址

/v1/rest/budgets

### 方法

GET

### 接口认证

在HTTP header中添加

access_token: xxxxx

access_token由预算系统生成分配，在接入前需要协商分配，修改也需要双方协商修改

### 参数说明

budgetCode（可选）：预算编号

cycle（可选）：预算周期

orgCode（可选）：组织编码

depCode（可选）：部门编码

subCode（可选）：科目编码

projCode（可选）：项目编码

#### 参数使用说明：

①budgetCode预算编号可以唯一确定一条预算数据

②cycle，orgCode，depCode，subCode，projCode可以唯一确定一条预算

根据①的预算编号和②的预算维度组合都可以确定唯一的预算，所以①和②在调用时必须选择其一传入。

#### 参数示例

预算编号：

```http
/v1/rest/budgets?budgetCode=QTCN2000411
```

预算维度：

```http
/v1/rest/budgets?cycle=2020&orgCode=x10001&depCode=10004&subCode=0100000&projCode=1000101
```

## 返回说明

**code**：调用接口，200代表接口成功，非200表示系统出错，具体出错信息请参考message提示信息

**message**：当code为200，message返回"成功"， 如果非200会提示相关的报错信息

**data**：当code为200时，接口返回预算的具体信息

budgetAmount: 预算的余额

controlType: 预算的控制方式（1.超预算不提示、2.超预算不提示、3.不可超预算）

#### 返回示例

* 成功：

```json
{
    "code": 200,
    "message": "成功",
    "data": {
        "budgetBalanceAmount": 2770616.0000,
        "controlType": 1
    }
}
```

```json
{
    "code": 200,
    "message": "成功",
    "data": {
        "budgetBalanceAmount": 29735300.0000,
        "controlType": 1
    }
}
```



* 失败

```json
{"code":"3000", "message":"传入参数不正确"}
```



# 3. 查询预算部门列表接口（可测试）

## 接口说明

获取预算系统的预算部门列表，根据调用系统的需要可以添加过滤或分页返回，目前返回所有数据的列表

## 请求说明

### 请求地址

/v1/rest/dimensionTypes/2/dimensions

### 方法

GET

### 参数说明

无传入参数

## 返回说明

**code**：调用接口，200代表接口成功，非200表示系统出错，具体出错信息请参考message提示信息

**message**：当code为200，message返回"成功"， 如果非200会提示相关的报错信息

**data**：当code为200时，接口返回预算的具体信息

code：部门编码

name：部门名称

### 返回示例

成功：

```json
{
    "code": 200,
    "message": "成功",
    "data": [
        {
            "code": "x10005",
            "name": "营销"
        },
        {
            "code": "10004",
            "name": "流程IT"
        },
        {
            "code": "10005",
            "name": "体系与流程IT"
        },
        {
            "code": "00100100",
            "name": "模拟一级级部门1-模拟二级部门1"
        },
        {
            "code": "00200102",
            "name": "模拟一级级部门2-模拟二级部门3-财务部"
        },
        {
            "code": "00200000",
            "name": "模拟一级级部门2"
        },
        {
            "code": "00200300",
            "name": "模拟一级级部门2-模拟二级部门5"
        },
        {
            "code": "00200305",
            "name": "模拟一级级部门2-模拟二级部门5-电商组"
        }
    ]
}
```

失败：

```json
{"code":"5000","message":"系统异常"}
```



# 4. 查询预算组织列表接口（可测试）

## 接口说明

获取预算系统的组织列表，根据调用系统的需要可以添加过滤或分页返回，目前返回所有数据的列表

## 请求说明

### 请求地址

/v1/rest/dimensionTypes/3/dimensions

### 方法

GET

### 参数说明

无传入参数

## 返回说明

**code**：调用接口，200代表接口成功，非200表示系统出错，具体出错信息请参考message提示信息

**message**：当code为200，message返回"成功"， 如果非200会提示相关的报错信息

**data**：当code为200时，接口返回预算的具体信息

code：组织编码

name：组织名称

### 返回示例

成功：

```json
{
    "code": 200,
    "message": "成功",
    "data": [
        {
            "code": "x10001",
            "name": "中国"
        },
        {
            "code": "x10002",
            "name": "印尼"
        },
        {
            "code": "x10003",
            "name": "西亚"
        },
        {
            "code": "x10004",
            "name": "南非"
        }
    ]
}
```

失败：

```json
{"code":"5000","message":"系统异常"}
```

# 5. 查询预算科目列表接口（可测试）

## 接口说明

获取预算系统的科目列表，根据调用系统的需要可以添加过滤或分页返回，目前返回所有数据的列表

## 请求说明

### 请求地址

/v1/rest/dimensionTypes/1/dimensions

### 方法

GET

### 参数说明

无传入参数

## 返回说明

**code**：调用接口，200代表接口成功，非200表示系统出错，具体出错信息请参考message提示信息

**message**：当code为200，message返回"成功"， 如果非200会提示相关的报错信息

**data**：当code为200时，接口返回预算的具体信息

code：科目编码

name：科目名称

### 返回示例

成功：

```json
{
    "code": 200,
    "message": "成功",
    "data": [
        {
            "code": "0100000",
            "name": "广告"
        },
        {
            "code": "0101000",
            "name": "广告-公关"
        },
        {
            "code": "0101001",
            "name": "广告-公关-基础运营"
        },
        {
            "code": "0101002",
            "name": "广告-公关-公关口碑"
        },
        {
            "code": "0101003",
            "name": "广告-公关-内容运营"
        },
        {
            "code": "0101004",
            "name": "广告-公关-品牌传播"
        },
        {
            "code": "0101005",
            "name": "广告-公关-企业传播"
        },
        {
            "code": "0103001",
            "name": "广告-其他-P资源"
        },
        {
            "code": "0103002",
            "name": "广告-其他-代理服务"
        }
    ]
}
```

失败：

```json
{"code":"5000","message":"系统异常"}
```

# 6. 查询预算项目列表接口（可测试）

## 接口说明

获取预算系统的项目列表，根据调用系统的需要可以添加过滤或分页返回，目前返回所有数据的列表

## 请求说明

### 请求地址

/v1/rest/dimensionTypes/4/dimensions

### 方法

GET

### 参数说明

无传入参数

## 返回说明

**code**：调用接口，200代表接口成功，非200表示系统出错，具体出错信息请参考message提示信息

**message**：当code为200，message返回"成功"， 如果非200会提示相关的报错信息

**data**：当code为200时，接口返回预算的具体信息

code：项目编码

name：项目名称

### 返回示例

成功：

```json
{
    "code": 200,
    "message": "成功",
    "data": [
        {
            "code": "1000101",
            "name": "X50"
        },
        {
            "code": "1000102",
            "name": "iqoo"
        }
    ]
}
```

失败：

```json
{"code":"5000","message":"系统异常"}
```

# 7. 根据维度查询预算接口

## 接口说明

根据指定的字段名称，获取指定字段相关的维度编码以及全维度数据

## 请求说明

### 请求地址

/v1/rest/budgets/dimension

### 方法

GET

### 参数说明

budgetCycle：预算周期

departmentCode：部门编码

organizationCode：组织编码

subjectCode：科目编码

projectCode：项目编码

#### 参数使用说明

以上参数都是可选的，但是至少传入一项，发送的字段越正确越多，返回的数据量越少

### 参数示例

```
/v1/rest/budgets/dimention?budgetCycle=2020&departmentCode=002
```

## 返回说明

**code**：调用接口，200代表接口成功，非200表示系统出错，具体出错信息请参考message提示信息

**message**：当code为200，message返回"成功"， 如果非200会提示相关的报错信息

**data**：当code为200时，接口返回预算数据的列表，具体的返回数据参考具体返回示例

budgetCode：预算编码

cycle: 预算周期

department：预算部门，包含编码code和名称name

organization: 预算组织 ，包含编码code和名称name

subject: 预算科目，包含编码code和名称name

project: 预算项目，包含编码code和名称name

### 返回示例：

成功：

```json
{
    "code": 200,
    "message": "成功",
    "data": [
        {
            "budgetCode": "YSBH001",
            "cycle": "2020",
            "organization": {
                "code": "001",
                "name": "中国"
            },
            "department": {
                "code": "002",
                "name": "营销部"
            },
            "subject": {
                "code": "001",
                "name": "团建费"
            },
            "project": {
                "code": "001",
                "name": "打车"
            }
        },
        {
            "budgetCode": "YSBH001",
            "cycle": "2020",
            "organization": {
                "code": "002",
                "name": "印度"
            },
            "department": {
                "code": "002",
                "name": "营销部"
            },
            "subject": {
                "code": "002",
                "name": "出差费"
            },
            "project": {
                "code": "002",
                "name": "住宿"
            }
        }
    ]
}
```

失败

```json
{"code":"1000","message":"错误提示信息"}
```

# 8. 获取预算剩余冻结金额

## 接口说明

通过外部系统的唯一编号获取预算维度以及剩余冻结金额

## 请求说明

### 请求地址

/v1/rest/budgets/sourceCode/{souceCode}

### 方法

GET

### 参数说明

souceCode：来源系统唯一码，比如合同系统就是合同号

### 参数示例

```
/v1/rest/budgets/sourceCode/FS-202011170001
```

## 返回说明

**code**：调用接口，200代表接口成功，非200表示系统出错，具体出错信息请参考message提示信息

**message**：当code为200，message返回"成功"， 如果非200会提示相关的报错信息

**data**：当code为200时，为预算列表，每条预算包含具体的余额信息

budgetCode：预算编码

cycle: 预算周期

department：预算部门，包含编码code和名称name

organization: 预算组织 ，包含编码code和名称name

subject: 预算科目，包含编码code和名称name

project: 预算项目，包含编码code和名称name

freezeAmount: 合计冻结金额

occupyAmount: 已占用金额

restFreezeAmount: 剩余冻结金额（合计冻结金额-已占用金额）

#### 返回示例

成功：

```json
{
    "code": 200,
    "message": "成功",
    "data": [
        {
            "budgetCode": "QTCN2000409",
            "cycle": "2020",
            "organization": {
                "code": "001",
                "name": "中国"
            },
            "department": {
                "code": "004",
                "name": "财经管理部"
            },
            "subject": {
                "code": "004",
                "name": "赠机"
            },
            "project": {
                "code": "002",
                "name": "无"
            },
            "freezeAmount": 2039425.0000,
            "occupyAmount": 0.0000,
            "restFreezeAmount": 2039425.0000
        },
        {
            "budgetCode": "QTCN2000408",
            "cycle": "2020",
            "organization": {
                "code": "001",
                "name": "中国"
            },
            "department": {
                "code": "004",
                "name": "财经管理部"
            },
            "subject": {
                "code": "004",
                "name": "赠机"
            },
            "project": {
                "code": "002",
                "name": "无"
            },
            "freezeAmount": 4915680.0000,
            "occupyAmount": 0.0000,
            "restFreezeAmount": 4915680.0000
        },
        {
            "budgetCode": "QTCN2000407",
            "cycle": "2020",
            "organization": {
                "code": "001",
                "name": "中国"
            },
            "department": {
                "code": "005",
                "name": "固网营销中心"
            },
            "subject": {
                "code": "004",
                "name": "赠机"
            },
            "project": {
                "code": "002",
                "name": "无"
            },
            "freezeAmount": 715983.0000,
            "occupyAmount": 0.0000,
            "restFreezeAmount": 715983.0000
        },
        {
            "budgetCode": "QTCN2000406",
            "cycle": "2020",
            "organization": {
                "code": "001",
                "name": "中国"
            },
            "department": {
                "code": "006",
                "name": "互联网商业运营部"
            },
            "subject": {
                "code": "005",
                "name": "互联网资源领用"
            },
            "project": {
                "code": "002",
                "name": "无"
            },
            "freezeAmount": 257463.0000,
            "occupyAmount": 0.0000,
            "restFreezeAmount": 257463.0000
        },
        {
            "budgetCode": "QTCN2000405",
            "cycle": "2020",
            "organization": {
                "code": "001",
                "name": "中国"
            },
            "department": {
                "code": "007",
                "name": "vivo电商运营部"
            },
            "subject": {
                "code": "006",
                "name": "代理分成"
            },
            "project": {
                "code": "003",
                "name": "京东POP"
            },
            "freezeAmount": 4764962.0000,
            "occupyAmount": 0.0000,
            "restFreezeAmount": 4764962.0000
        },
        {
            "budgetCode": "QTCN2000404",
            "cycle": "2020",
            "organization": {
                "code": "001",
                "name": "中国"
            },
            "department": {
                "code": "007",
                "name": "vivo电商运营部"
            },
            "subject": {
                "code": "006",
                "name": "代理分成"
            },
            "project": {
                "code": "004",
                "name": "京东自营"
            },
            "freezeAmount": 2901340.0000,
            "occupyAmount": 0.0000,
            "restFreezeAmount": 2901340.0000
        },
        {
            "budgetCode": "QTCN2000403",
            "cycle": "2020",
            "organization": {
                "code": "001",
                "name": "中国"
            },
            "department": {
                "code": "007",
                "name": "vivo电商运营部"
            },
            "subject": {
                "code": "006",
                "name": "代理分成"
            },
            "project": {
                "code": "005",
                "name": "苏宁自营"
            },
            "freezeAmount": 804152.0000,
            "occupyAmount": 0.0000,
            "restFreezeAmount": 804152.0000
        },
        {
            "budgetCode": "QTCN2000402",
            "cycle": "2020",
            "organization": {
                "code": "001",
                "name": "中国"
            },
            "department": {
                "code": "007",
                "name": "vivo电商运营部"
            },
            "subject": {
                "code": "006",
                "name": "代理分成"
            },
            "project": {
                "code": "006",
                "name": "天猫分销"
            },
            "freezeAmount": 4574598.0000,
            "occupyAmount": 0.0000,
            "restFreezeAmount": 4574598.0000
        }
    ]
}
```

失败：

```json
{"code":"1500","message":"错误提示信息"}
```



